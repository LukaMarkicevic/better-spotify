{"version":3,"sources":["Login.js","Player.js","TrackSearchResult.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","title","artist","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5a362707.chunk.js","sourcesContent":["import React from \"react\"\r\nimport { Container } from \"react-bootstrap\"\r\n\r\nconst AUTH_URL =\r\n  \"https://accounts.spotify.com/authorize?client_id=cfc90945a74b46ad8db89e6716d59e65&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\"\r\n\r\nexport default function Login() {\r\n  return (\r\n    <Container\r\n      className=\"d-flex justify-content-center align-items-center\"\r\n      style={{ minHeight: \"100vh\" }}\r\n    >\r\n      <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\r\n        Login With Spotify\r\n      </a>\r\n    </Container>\r\n  )\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport SpotifyPlayer from \"react-spotify-web-playback\"\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n  const [play, setPlay] = useState(false)\r\n\r\n  useEffect(() => setPlay(true), [trackUri])\r\n\r\n  if (!accessToken) return null\r\n  return (\r\n    <SpotifyPlayer\r\n      token={accessToken}\r\n      showSaveIcon\r\n      callback={state => {\r\n        if (!state.isPlaying) setPlay(false)\r\n      }}\r\n      play={play}\r\n      uris={trackUri ? [trackUri] : []}\r\n    />\r\n  )\r\n}\r\n","import React from \"react\"\r\n\r\nexport default function TrackSearchResult({ track, chooseTrack }) {\r\n  function handlePlay() {\r\n    chooseTrack(track)\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"d-flex m-2 align-items-center\"\r\n      style={{ cursor: \"pointer\" }}\r\n      onClick={handlePlay}\r\n    >\r\n      <img src={track.albumUrl} style={{ height: \"64px\", width: \"64px\" }} />\r\n      <div className=\"ml-3\">\r\n        <div>{track.title}</div>\r\n        <div className=\"text-muted\">{track.artist}</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport useAuth from \"./useAuth\"\r\nimport Player from \"./Player\"\r\nimport TrackSearchResult from \"./TrackSearchResult\"\r\nimport { Container, Form } from \"react-bootstrap\"\r\nimport SpotifyWebApi from \"spotify-web-api-node\"\r\nimport axios from \"axios\"\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n  clientId: \"cfc90945a74b46ad8db89e6716d59e65\",\r\n})\r\n\r\nexport default function Dashboard({ code }) {\r\n  const accessToken = useAuth(code)\r\n  const [search, setSearch] = useState(\"\")\r\n  const [searchResults, setSearchResults] = useState([])\r\n  const [playingTrack, setPlayingTrack] = useState()\r\n  const [lyrics, setLyrics] = useState(\"\")\r\n\r\n  function chooseTrack(track) {\r\n    setPlayingTrack(track)\r\n    setSearch(\"\")\r\n    setLyrics(\"\")\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!playingTrack) return\r\n\r\n    axios\r\n      .get(\"http://localhost:3001/lyrics\", {\r\n        params: {\r\n          track: playingTrack.title,\r\n          artist: playingTrack.artist,\r\n        },\r\n      })\r\n      .then(res => {\r\n        setLyrics(res.data.lyrics)\r\n      })\r\n  }, [playingTrack])\r\n\r\n  useEffect(() => {\r\n    if (!accessToken) return\r\n    spotifyApi.setAccessToken(accessToken)\r\n  }, [accessToken])\r\n\r\n  useEffect(() => {\r\n    if (!search) return setSearchResults([])\r\n    if (!accessToken) return\r\n\r\n    let cancel = false\r\n    spotifyApi.searchTracks(search).then(res => {\r\n      if (cancel) return\r\n      setSearchResults(\r\n        res.body.tracks.items.map(track => {\r\n          const smallestAlbumImage = track.album.images.reduce(\r\n            (smallest, image) => {\r\n              if (image.height < smallest.height) return image\r\n              return smallest\r\n            },\r\n            track.album.images[0]\r\n          )\r\n\r\n          return {\r\n            artist: track.artists[0].name,\r\n            title: track.name,\r\n            uri: track.uri,\r\n            albumUrl: smallestAlbumImage.url,\r\n          }\r\n        })\r\n      )\r\n    })\r\n\r\n    return () => (cancel = true)\r\n  }, [search, accessToken])\r\n\r\n  return (\r\n    <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\" }}>\r\n      <Form.Control\r\n        type=\"search\"\r\n        placeholder=\"Search Songs/Artists\"\r\n        value={search}\r\n        onChange={e => setSearch(e.target.value)}\r\n      />\r\n      <div className=\"flex-grow-1 my-2\" style={{ overflowY: \"auto\" }}>\r\n        {searchResults.map(track => (\r\n          <TrackSearchResult\r\n            track={track}\r\n            key={track.uri}\r\n            chooseTrack={chooseTrack}\r\n          />\r\n        ))}\r\n        {searchResults.length === 0 && (\r\n          <div className=\"text-center\" style={{ whiteSpace: \"pre\" }}>\r\n            {lyrics}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <Player accessToken={accessToken} trackUri={playingTrack?.uri} />\r\n      </div>\r\n    </Container>\r\n  )\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport axios from \"axios\"\r\n\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState()\r\n  const [refreshToken, setRefreshToken] = useState()\r\n  const [expiresIn, setExpiresIn] = useState()\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .post(\"http://localhost:3001/login\", {\r\n        code,\r\n      })\r\n      .then(res => {\r\n        setAccessToken(res.data.accessToken)\r\n        setRefreshToken(res.data.refreshToken)\r\n        setExpiresIn(res.data.expiresIn)\r\n        window.history.pushState({}, null, \"/\")\r\n      })\r\n      .catch(() => {\r\n        window.location = \"/\"\r\n      })\r\n  }, [code])\r\n\r\n  useEffect(() => {\r\n    if (!refreshToken || !expiresIn) return\r\n    const interval = setInterval(() => {\r\n      axios\r\n        .post(\"http://localhost:3001/refresh\", {\r\n          refreshToken,\r\n        })\r\n        .then(res => {\r\n          setAccessToken(res.data.accessToken)\r\n          setExpiresIn(res.data.expiresIn)\r\n        })\r\n        .catch(() => {\r\n          window.location = \"/\"\r\n        })\r\n    }, (expiresIn - 60) * 1000)\r\n\r\n    return () => clearInterval(interval)\r\n  }, [refreshToken, expiresIn])\r\n\r\n  return accessToken\r\n}\r\n","import \"bootstrap/dist/css/bootstrap.min.css\"\r\nimport Login from \"./Login\"\r\nimport Dashboard from \"./Dashboard\"\r\n\r\nconst code = new URLSearchParams(window.location.search).get(\"code\")\r\n\r\nfunction App() {\r\n  return code ? <Dashboard code={code} /> : <Login />\r\n}\r\n\r\nexport default App\r\n","import React from \"react\"\r\nimport ReactDOM from \"react-dom\"\r\nimport App from \"./App\"\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n)\r\n"],"sourceRoot":""}